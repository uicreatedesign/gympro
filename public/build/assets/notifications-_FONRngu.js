import{e as u,a as $,r as x,j as e,H as M,t as i,b as z}from"./app-CeYbb0ey.js";import{A as O}from"./app-layout-C80MmBOv.js";import{S as F}from"./layout-CjrvJLLg.js";import{b as p,C as m,a as f,d as S,c as h}from"./card-EPZNldzm.js";import{B as n}from"./app-logo-icon-BJjrVBLl.js";import{A as B,a as D}from"./alert-CfVuEUu-.js";import{B as w}from"./app-sidebar-layout-VvhSTCcV.js";import{C as H}from"./circle-alert-DdH7DEnq.js";import{M as I}from"./mail-f9Ymq5M8.js";/* empty css            */import"./separator-ocqeKh9b.js";import"./index-mWMNGgim.js";import"./index-Cx2XN_pX.js";import"./index-CE1SuMX5.js";import"./index-BOxVAIo7.js";import"./app-logo-DqAeFtE0.js";import"./users-CHsfhasw.js";const q=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],L=u("MessageSquare",q);const P=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],R=u("Send",P);const J=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Q=u("Smartphone",J),V=[{title:"Notification Settings",href:"/settings/notifications"}],k={email:e.jsx(I,{className:"h-4 w-4"}),push:e.jsx(w,{className:"h-4 w-4"}),sms:e.jsx(Q,{className:"h-4 w-4"}),whatsapp:e.jsx(L,{className:"h-4 w-4"})},v={email:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300",push:"bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300",sms:"bg-orange-100 dark:bg-orange-900 text-orange-600 dark:text-orange-300",whatsapp:"bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300"};function ce({settings:g,events:c,channels:r}){const{props:C}=$(),[o,l]=x.useState(g),[j,d]=x.useState(!1),[b,N]=x.useState(null),E=(s,t)=>{l(a=>({...a,[s]:{...a[s],[t]:!a[s][t]}}))},A=async s=>{N(s);try{const a=await(await fetch("/settings/notifications/test",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":C.csrf_token||""},body:JSON.stringify({channel:s})})).json();a.success?i.success(`Test notification sent via ${s}`):i.error(a.message||`Failed to send test notification via ${s}`)}catch{i.error(`Failed to send test notification via ${s}`)}finally{N(null)}},T=s=>{s.preventDefault(),d(!0),z.post("/settings/notifications",{settings:o},{onSuccess:()=>{i.success("Notification settings updated successfully"),d(!1)},onError:()=>{i.error("Failed to update notification settings"),d(!1)}})},y=s=>Object.values(o[s]||{}).filter(Boolean).length;return e.jsxs(O,{breadcrumbs:V,children:[e.jsx(M,{title:"Notification Settings"}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Notification Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure which events trigger notifications and through which channels"})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs(p,{children:[e.jsxs(m,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"Notification Channels"]}),e.jsx(S,{children:"Test and manage your notification channels"})]}),e.jsxs(h,{className:"space-y-3",children:[r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded ${v[s]}`,children:k[s]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[s," Notifications"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y(s)>0?`Enabled for ${Object.values(o).filter(t=>t[s]).length} events`:"Not enabled for any events"})]})]}),e.jsxs(n,{type:"button",variant:"outline",size:"sm",onClick:()=>A(s),disabled:b===s,children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),b===s?"Sending...":"Test"]})]},s)),(r.includes("sms")||r.includes("whatsapp"))&&e.jsxs(B,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(D,{className:"text-xs",children:"SMS and WhatsApp require API configuration. Contact support for setup."})]})]})]}),e.jsxs(p,{children:[e.jsxs(m,{children:[e.jsx(f,{children:"Event Notification Matrix"}),e.jsx(S,{children:"Select which channels should notify you for each event"})]}),e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Event"}),r.map(s=>e.jsx("th",{className:"text-center py-3 px-4 font-semibold",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`p-2 rounded ${v[s]}`,children:k[s]}),e.jsx("span",{className:"text-xs capitalize",children:s})]})},s))]})}),e.jsx("tbody",{children:Object.entries(c).map(([s,t])=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:t}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y(s)," of ",r.length," enabled"]})]})}),r.map(a=>e.jsx("td",{className:"text-center py-4 px-4",children:e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o[s]?.[a]??!0,onChange:()=>E(s,a),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})},`${s}-${a}`))]},s))})]})})})]}),e.jsxs(p,{children:[e.jsx(m,{children:e.jsx(f,{className:"text-base",children:"Quick Actions"})}),e.jsxs(h,{className:"flex gap-2",children:[e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s={};Object.keys(c).forEach(t=>{s[t]={},r.forEach(a=>{s[t][a]=!0})}),l(s)},children:"Enable All"}),e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s={};Object.keys(c).forEach(t=>{s[t]={},r.forEach(a=>{s[t][a]=!1})}),l(s)},children:"Disable All"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>l(g),children:"Reset"}),e.jsx(n,{type:"submit",disabled:j,children:j?"Saving...":"Save Settings"})]})]})]})})]})}export{ce as default};
